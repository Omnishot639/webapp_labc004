<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Estoque de Reagentes - Laboratório</title>
  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <header>
    <h1>Estoque e Agenda - Laboratório de Micologia</h1>
    <div class="login-area">
    {% if usuario %}
      <span id="user-display">Bem-vindo, {{ usuario.nome }}</span>
      <a href="/logout">Logout</a>
      {% if usuario.is_admin %}
      {% endif %}
    {% else %}
      <a href="/login">Login</a>
    {% endif %}
    </div>
  </header>

  <nav>
    <button onclick="showTab('reagentes')">Reagentes</button>
    <button onclick="showTab('meios')">Meios de Cultura</button>
    <button onclick="showTab('agenda')">Agenda</button>
    <button onclick="showTab('usuarios')">Gerenciar Usuários</button>
  </nav>

  <section id="reagentes" class="active">
    <h2>Reagentes</h2>
    <table>
      <thead>
        <tr><th>Nome</th><th>Quantidade</th><th>Validade</th><th>Localização</th><th class="edit-only hidden">Ações</th></tr>
      </thead>
      <tbody id="reagentes-body">
        {% for r in reagentes %}
        <tr>
          <td>{{ r.nome }}</td>
          <td>{{ r.quantidade }}</td>
          <td>{{ r.validade }}</td>
          <td>{{ r.localizacao }}</td>
          <td class="edit-only hidden">
            <button onclick="editar(this, 'reagentes', {{ r.id }})">Editar</button>
            <button onclick="remover(this, 'reagentes', {{ r.id }})">Remover</button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <button class="edit-only hidden" onclick="adicionar('reagentes')">Adicionar Reagente</button>
  </section>

  <section id="meios">
    <h2>Meios de Cultura</h2>
    <table>
      <thead>
        <tr><th>Nome</th><th>Quantidade</th><th>Validade</th><th>Localização</th><th class="edit-only hidden">Ações</th></tr>
      </thead>
      <tbody id="meios-body">
        {% for m in meios %}
        <tr>
          <td>{{ m.nome }}</td>
          <td>{{ m.quantidade }}</td>
          <td>{{ m.validade }}</td>
          <td>{{ m.localizacao }}</td>
          <td class="edit-only hidden">
            <button onclick="editar(this, 'meios', {{ m.id }})">Editar</button>
            <button onclick="remover(this, 'meios', {{ m.id }})">Remover</button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <button class="edit-only hidden" onclick="adicionar('meios')">Adicionar Meio</button>
  </section>

  <section id="agenda">
    <h2>Cronograma de Equipamentos e Vidrarias</h2>
    <table>
      <thead>
        <tr><th>Equipamento</th><th>Usuário</th><th>Data</th><th>Horário</th><th class="edit-only hidden">Ações</th></tr>
      </thead>
      <tbody id="agenda-body">
        {% for a in agenda %}
        <tr>
          <td>{{ a.equipamento }}</td>
          <td>{{ a.usuario }}</td>
          <td>{{ a.data }}</td>
          <td>{{ a.horario }}</td>
          <td class="edit-only hidden">
            <button onclick="editar(this, 'agenda', {{ a.id }})">Editar</button>
            <button onclick="remover(this, 'agenda', {{ a.id }})">Remover</button>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <button class="edit-only hidden" onclick="adicionar('agenda')">Adicionar Agendamento</button>
  
  {% if usuario and usuario.is_admin %}
    <section id="usuarios">
      <h2>Gerenciamento de Usuários</h2>
      <table>
        <thead>
          <tr>
            <th>Nome</th>
            <th>Admin?</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody id="usuarios-body">
        </tbody>
      </table>
      <h3>Adicionar Novo Usuário</h3>
      <form id="form-usuario" onsubmit="return adicionarUsuario()">
        <input type="text" id="novo-nome" placeholder="Nome" required />
        <input type="password" id="nova-senha" placeholder="Senha" required />
        <label>
          <input type="checkbox" id="novo-admin" />
          Admin
        </label>
        <button type="submit">Adicionar</button>
      </form>
    </section>
  {% endif %}

</body>
</html>
